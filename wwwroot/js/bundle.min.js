var calendar=function(){"use strict";var e="calendar",t=null,n={updated:"2016-06-22T10:00:00"},i=[],a=[],o=[],r=[],d=null,u=null,s=null,l=null,c=null,m=0,f=$("<audio>"),g=function(){var e=new Date;return e.setDate(e.getDate()-17),e.toISOString()},h=function(){var e=new Date;return e.setDate(e.getDate()+17),e.toISOString()},w={element:"#calendar",url:"https://www.googleapis.com/calendar/v3/calendars/{0}/events/",account:config.calendar.accounts[0].account,key:config.calendar.accounts[0].token,alwaysIncludeEmail:!1,showDeleted:!1,timeMin:g(),timeMax:h(),upcommingEvents:10,pastEvents:10,dateFormat:"dd MMMM",blinkSpeed:5e3,refresh:10,sound:"sounds/beep.mp3",debug:!1},p=function(e){w=$.extend({},w,e),w.element=$(w.element),w.debug=w.debug?w.debug:config.debug,w.element.addClass("module refresh"),m=w.refresh},y=function(){var e=_.omit(w,["url","account","refresh","upcommingEvents","pastEvents","element","dateFormat","sort","sound","debug","blinkSpeed"]);w.url=w.url.format(w.account),w.url+="?"+$.param(e)},v=function(){i=[],a=[],o=[],$.getJSON(w.url,function(e){n=e,D(e.items),L(),b()})},b=function(){i.forEach(function(e){if(e.recurrence){i=_.without(i,e);var t=w.url.replace("/events/","/events/"+e.recurrence+"/instances");$.getJSON(t,function(e){D(e.items),L()})}})},D=function(e){e.forEach(function(e){var t={title:e.summary.replace(/[❤️]/gm,"")||"",startDate:new Date(e.start.date||e.start.dateTime),endDate:new Date(e.end.date||e.end.dateTime),location:e.location||null,recurrence:e.recurrence?e.id:null};i.push(t)})},M=function(){a=_.filter(i,function(e){return e.startDate>=new Date||e.endDate>=new Date}),a=_.sortBy(a,function(e){return e.startDate}).filter(function(e,t){return t<w.upcommingEvents}),o=_.filter(i,function(e){return e.startDate<new Date&&e.endDate<new Date}),o=_.sortBy(o,function(e){return e.startDate}).reverse().filter(function(e,t){return t<w.pastEvents})},T=function(){sffjs.setCulture("nl-NL");var e=C(a),t=C(o),n=$('<thead><tr><th class="icon"></th><th></th><th></th></tr></thead>'),i=$("<tbody><tr><th colspan=3><h4>Historie</h4></th></tr></tbody>"),r=$("<table>");r.addClass("fader"),r.addClass("gradient"),r.append(n),r.append(e),r.append(i),r.append(t),w.element.html(r)},C=function(e){var t=$("<tbody>");return e.forEach(function(e){var n=k(e),i=e.startDate.format(w.dateFormat),a=$('<td class="glyphicon glyphicon-calendar">'),o=$("<th>").html(e.title),r=$('<td class="right">').html(i);r.attr({"data-diff":n,"data-date":i});var d=$("<tr>").append(a).append(o).append(r);t.append(d)}),t},k=function(e){var t=e.startDate,n=e.endDate,i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=N(a,o).d;return i>=t&&n>i?"<span>Nu</span>":0==r&&(t>i||i>=n)?"Vandaag":1==r?"Morgen":-1==r?"Gister":r>0?r+" dgn.":0>r?Math.abs(r)+" dgn. gldn.":void 0},x=function(){w.blinkSpeed>0&&(window.clearTimeout(d),window.clearTimeout(u),window.clearTimeout(s),window.clearTimeout(l),u=window.setTimeout(S.bind("fadeOutSwitch","td[data-date]"),w.blinkSpeed-750),d=window.setTimeout(H,w.blinkSpeed),s=window.setTimeout(S.bind("fadeInSwitch","td[data-date]"),w.blinkSpeed+50),l=window.setTimeout(x,w.blinkSpeed+51))},H=function(){w.element.find("td[data-date]").each(function(e,t){t=$(t);var n=t.attr("data-date"),i=t.attr("data-diff"),a=n==t.html()?i:n;t.html(a)})},S=function(e){w.element.find(e).toggleClass("fader")},F=function(){var e=new Date,t=_.map(a,function(t){return e<t.startDate?t.startDate-e:t.endDate-e}),i=_.sortBy(t,function(e){return e});m=Math.min(($(i).get(0)/6e4).round(2),w.refresh);var o=m>60?m/60:m,r=m>60?"hours.":"minutes.";console.log("Refresh calendar in",o.toFixed(2),r),n.updated=e.toString()},N=function(e,t){var n=Date.parse(t)-Date.parse(e);return isNaN(n)?NaN:{diff:n,ms:Math.floor(n%1e3),s:Math.floor(n/1e3%60),m:Math.floor(n/6e4%60),h:Math.floor(n/36e5%24),d:Math.floor(n/864e5)}},E=function(){""!=w.sound&&f.attr({src:w.sound,autostart:!1})},R=function(){f.get(0).play()},z=function(){M(),T(),w.blinkSpeed>0&&(H(),x()),O(!1),F(),U(),R()},L=function(){window.clearTimeout(c),c=window.setTimeout(z,300)},j=function(){U(),r=a;var i=new Date(n.updated),o=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes()+m),d=new Date;o>d||(console.log(e.capitalize(),"Refresh",(new Date).format("yyyy-MM-dd HH:mm")),window.clearTimeout(t),O(),v())},O=function(e){"undefined"!=typeof e?w.element.toggleClass("refresh",e):w.element.toggleClass("refresh")},U=function(){window.clearTimeout(t),t=window.setTimeout(j,60*m*1e3)};return{name:e,init:function(e){p(e)},start:function(){return w.debug?(T(),void O(!1)):(y(),E(),void v())},refresh:function(){j()}}}(),clock=function(){"use strict";var e="clock",t=new Date,n=null,i=null,a=null,o={element:"#clock",timeFormat:"h:mm tt",timeElement:"#time",dateFormat:"dddd, d MMMM yyyy",dateElement:"#date",blink:!0,fade:!0},r=function(e){o=$.extend({},o,e),o.element=$(o.element),o.element.addClass("module"),o.fade&&o.element.addClass("fader")},d=function(){sffjs.setCulture("en-US");var e=o.blink?o.timeFormat.replace(":","\\<\\b\\>:\\<\\/\\b\\>"):o.timeFormat;t=new Date;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()+1)-t,a=t.format(e);o.element.find("#time").html(a),i=window.setTimeout(d,n)},u=function(){sffjs.setCulture("nl-NL"),t=new Date;var e=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,100)-t,n=t.format(o.dateFormat);o.element.find("#date").html(n),a=window.setTimeout(u,e)},s=function(){window.clearTimeout(i),window.clearTimeout(a)},l=function(){var i="yyyy-MM-dd HH:mm",a=t.format(i),o=(new Date).format(i);a!=o&&(console.log(e.capitalize(),"Refresh"),window.clearTimeout(n),c(),d(),u(),n=window.setTimeout(c,1e3))},c=function(e){o.element.toggleClass("refresh")};return{name:e,init:function(e){r(e)},start:function(){d(),u()},stop:function(){s()},refresh:function(){l()}}}(),config={debug:!1,locale:"nl-NL",calendar:{accounts:[{account:"ramonklanke@gmail.com",token:"AIzaSyCDL-0KhtoC6xu4O0SGbyqBR_L29wqaAz4"},{account:"inhousemedia@hotmail.com",token:"xxx"},{account:"evelienklein1@yahoo.com",token:"xxx"}]},weather:{accounts:[{account:"info@inhousemedia.nl",token:"791d3a107b2b02c20d44aed4607f7895"}]},news:{accounts:[{account:"ramonklanke@hotmail.com",token:"d4740e3d2b5b45158782cc7baed7d39a"}]}},modules=function(){"use strict";var e={modules:{}},t=function(){$("body").on("refresh",r)},n=function(t,n){var i={};i[t.name]=t,i[t.name].init(n),e.modules=$.extend({},e.modules,i)},i=function(t){delete e.modules[t]},a=function(){_.mapObject(e.modules,function(e){e.start()})},o=function(t){return e.modules[t]},r=function(t,n){return null==n?void _.mapObject(e.modules,function(e){e.refresh()}):n&&e.modules.hasOwnProperty(n)?void e.modules[n].refresh():void 0};return{init:function(){t()},start:function(){a()},register:function(e,t){n(e,t)},unregister:function(e){i(e)},refresh:function(e){r(null,e)},get:function(e){return o(e)}}}(),news=function(){"use strict";var e="news",t=null,n=null,i=0,a=0,o={element:"#news",url:"https://api.cognitive.microsoft.com/bing/v5.0/news{0}?count={1}&mkt={2}&setLang={3}&freshness={4}&headlineCount={1}",account:config.news.accounts[0].account,key:config.news.accounts[0].token,total:10,type:"",age:"Day",refresh:15,blinkSpeed:5e3,debug:!1},r=function(e){o=$.extend({},o,e),o.element=$(o.element),o.debug=o.debug?o.debug:config.debug,o.element.addClass("module refresh")},d=function(){var e=config.locale.split("-").pop();o.url=o.url.format(o.type,o.total,config.locale,e,o.age),console.log(o.url)},u=function(){jQuery.support.cors=!0,$.ajax({url:o.url,type:"GET",contentType:"application/json",crossDomain:!0,headers:{"Ocp-Apim-Subscription-Key":o.key,"Content-Type":"application/json"},dataType:"json",success:function(e){null!==n&&$(e).get(0).datePublished==$(n).get(0).datePublished||(n=e,i=0,s(),l(),f(!1),c())}})},s=function(){n.value=_.sortBy(n.value,function(e){return e.datePublished}).reverse()},l=function(){var e=$(n.value).get(i),t=new Date-new Date(e.datePublished);console.log("----",t,e.name,i,n.value.length);var r=t>36e5?Math.round(t/36e5)+" uur geleden":Math.round(t/6e4)+" minuten geleden";r=6e4>t?"nu":r;var d=e.name.replace(/[\'\"\“\”\‘\’]/gm,""),u=$(e.provider).get(0).name||"",s=$("<table><tbody><tr><td>"+r+"</td></tr><tr><th><h3>"+d+"</h3><span>"+u+"</span></th></tr></tbody></table>");o.element.html(s),n.value.length-1==i?(i=0,m()):i++,a=d.split("_").length||5},c=function(){window.clearTimeout(t),window.setTimeout(g,8e3*a-750),t=window.setTimeout(l,8e3*a),window.setTimeout(g,8e3*a+50),window.setTimeout(c,8e3*a+51)},m=function(){u()},f=function(e){"undefined"!=typeof e?o.element.toggleClass("refresh",e):o.element.toggleClass("refresh")},g=function(){o.element.toggleClass("fader")};return{name:e,init:function(e){r(e)},start:function(){return o.debug?(_createTable(),void f(!1)):(d(),void u())},refresh:function(){m()}}}();String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}),Number.prototype.round||(Number.prototype.round=function(e){return+(Math.round(this+"e+"+e)+"e-"+e)}),window.console||(window.console={});var refresh=function(){"use strict";var e="refresh",t=null,n=null,i=null,a=null,o=null,r=null,d=null,u=null,s={motionDetection:!0,blurTimer:2e4,snapRate:800,sensitivity:10,videoWidth:640,videoHeight:480,imageWidth:64,imageHeight:48,debug:!1},l=function(e){s=$.extend({},s,e),s.element=$(s.element),s.debug=s.debug?s.debug:config.debug,i=$("<canvas>").attr({width:s.imageWidth,height:s.imageHeight}),a=i.get(0).getContext("2d")},c=function(){var e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0,10),n=Math.round((t-e)/1e3),i=$("<meta>").attr({"http-equiv":"refresh",content:n});i.insertAfter($("head meta[charset]"));var a=n/3600>1?n/3600:n/60,o=n/3600>1?"hours.":"minutes.";console.log("Refresh page in",a.toFixed(2),o)},m=function(){s.motionDetection&&(t=window.setTimeout(b,s.blurTimer))},f=function(){var e=$("<video>").attr({autoplay:!0,id:"motion",width:s.videoWidth,height:s.videoHeight});e.click(p),o=e.get(0),s.debug&&$("body").append(e)},g=function(){var e={video:!0};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia(e,function(e){o.src=window.URL.createObjectURL(e),o.play(),r=e}.bind(this),function(e){console.log(e.code)})},h=function(){d=$("<canvas>").attr({id:"canvas",width:s.imageWidth,height:s.imageHeight}),u=d.get(0).getContext("2d"),s.debug&&$("body").append(d)},w=function(){a.drawImage(o,0,0,s.videoWidth,s.videoHeight,0,0,s.imageWidth,s.imageHeight);var e=a.getImageData(0,0,s.imageWidth,s.imageHeight),t=e.data;return t},p=function(){var e,i,a=w();window.setTimeout(function(){e=w(),i=y(a,e),u.putImageData(i.imageData,0,0),s.debug&&($(d).css({border:"1px solid "+(i.procent>=s.sensitivity?"red":"transparent")}),$(o).css({border:"1px solid "+(i.procent>=s.sensitivity?"red":"transparent")})),i.procent>=s.sensitivity&&($("body").hasClass("loading")&&(v(),$("body").trigger("refresh")),console.log("motion trigger",i.procent,"%"),window.clearTimeout(t),t=window.setTimeout(b,s.blurTimer))},s.snapRate),n=window.setTimeout(p,s.snapRate)},y=function(e,t){for(var n=a.getImageData(0,0,s.imageWidth,s.imageHeight),i=n.data,o=0,r=0;r<e.length;r+=4){var d=(e[r]+e[r+1]+e[r+2])/3,u=(t[r]+t[r+1]+t[r+2])/3,l=Math.abs(d-u)>30?255:0;i[r]=l,i[r+1]=l,i[r+2]=l,o+=l>0?1:0}var c=Math.round(o/(e.length/4)*100);return s.debug&&console.log(c+"%"),{imageData:n,procent:c}},v=function(){$("body.loading").removeClass("loading")},b=function(){$("body").addClass("loading")};return{name:e,init:function(e){l(e)},start:function(){c(),s.motionDetection&&(m(),this.motion())},refresh:function(){},focus:function(){v()},blur:function(){b()},motion:function(){s.motionDetection&&(f(),g(),h(),p())},stop:function(){r.active&&(window.clearTimeout(n),r.getTracks()[0].stop())}}}();$(document).ready(function(){sffjs.setCulture("nl-NL"),modules.init(),modules.register(clock),modules.register(weather),modules.register(weatherforecast),modules.register(calendar,{upcommingEvents:5,pastEvents:5}),modules.register(refresh),modules.register(news),modules.start()}),$(window).load(function(){modules.get("refresh").focus()});var weather=function(){"use strict";var e="weather",t=null,n=52.1006502,i=5.171758,a={coord:{lon:5.28,lat:52.7},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04d"}],base:"stations",main:{temp:16.21,pressure:1022,humidity:87,temp_min:12,temp_max:21.11},visibility:1e4,wind:{speed:6.7,deg:360},clouds:{all:90},dt:1465378214,sys:{type:1,id:5213,message:.0434,country:"NL",sunrise:1465355761,sunset:1465416037},id:2756076,name:"Gemeente Enkhuizen",cod:200},o={"01d":"wi-day-sunny","02d":"wi-day-cloudy","03d":"wi-cloudy","04d":"wi-cloudy-windy","09d":"wi-showers","10d":"wi-rain","11d":"wi-thunderstorm","13d":"wi-snow","50d":"wi-fog","01n":"wi-night-clear","02n":"wi-night-cloudy","03n":"wi-night-cloudy","04n":"wi-night-cloudy","09n":"wi-night-showers","10n":"wi-night-rain","11n":"wi-night-thunderstorm","13n":"wi-night-snow","50n":"wi-night-alt-cloudy-windy"},r={element:"#weather",url:"http://api.openweathermap.org/data/2.5/weather?units={3}&lat={0}&lon={1}&appid={2}",account:config.weather.accounts[0].account,key:config.weather.accounts[0].token,dateFormat:"HH:mm",units:"metric",refresh:15,debug:!1},d=function(e){r=$.extend({},r,e),r.element=$(r.element),r.debug=r.debug?r.debug:config.debug,r.element.addClass("module refresh")},u=function(){navigator.geolocation.getCurrentPosition(s,l)},s=function(e){n=e.coords.latitude,i=e.coords.longitude,h()},l=function(t){console.warn(e.capitalize(),"No location found"),h()},c=function(){r.url=r.url.format(n,i,r.key,r.units)},m=function(){$.getJSON(r.url,function(e){e.dt!=a.dt&&(a=e,g())},function(){console.warn(e.capitalize(),"No data found")})},f=function(e){var t="";return e>=350&&10>=e?t="wi wi-wind-north":e>10&&80>e?t="wi wi-wind-north-east":e>=80&&100>=e?t="wi wi-wind-east":e>100&&170>e?t="wi wi-wind-south-east":e>=170&&190>=e?t="wi wi-wind-south":e>190&&260>e?t="wi wi-wind-south-west":e>=260&&280>=e?t="wi wi-wind-west":e>280&&350>e&&(t="wi wi-wind-north-west"),t},g=function(){sffjs.setCulture("nl-NL");var t=new Date,n=new Date(1e3*a.sys.sunrise),i=new Date(1e3*a.sys.sunset),d=t>n&&i>t?i:n,u=t>n&&i>t?"wi wi-sunset":"wi wi-sunrise",s=$("<h3>"),l=$("<span>").html(a.name.replace("Gemeente","").trim()),c=$('<span class="wi wi-strong-wind"></span>'),m=$("<span>").html(a.wind.speed),g=$("<span>").addClass(f(a.wind.deg)),h=$("<span>").addClass(u),i=$("<span>").html(d.format(r.dateFormat));s.append(l).append(h).append(i).append(c).append(m).append(g);var w=$("<h1>"),p=$("<span>").addClass("wi "+o[$(a.weather).get(0).icon]),y="metric"==r.units?"&deg;":"";w.append(p).append(a.main.temp.toFixed(1)+y),r.element.find("#sunset").html(s),r.element.find("#temperature").html(w),console.log(e.capitalize(),"Last update",new Date(1e3*a.dt).format("yyyy-MM-dd HH:mm"))},h=function(){c(),m(),p(!1),y()},w=function(){y();var n=new Date(1e3*a.dt),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes()+r.refresh),o=new Date;i>o||(console.log(e.capitalize(),"Refresh",(new Date).format("yyyy-MM-dd HH:mm")),window.clearTimeout(t),p(),u())},p=function(e){"undefined"!=typeof e?r.element.toggleClass("refresh",e):r.element.toggleClass("refresh")},y=function(){window.clearTimeout(t),t=window.setTimeout(w,60*Math.round(r.refresh/3)*1e3)};return{name:e,init:function(e){d(e)},start:function(){return r.debug?(g(),void p(!1)):void u()},refresh:function(){w()}}}(),weatherforecast=function(){"use strict";var e="weatherforecast",t=null,n=52.1006502,i=5.171758,a={city:{id:2756076,name:"Gemeente Enkhuizen",coord:{lon:5.28333,lat:52.700001},country:"NL",population:0},cod:"200",message:.0531,cnt:7,list:[{dt:1465815600,temp:{day:18.24,min:12.19,max:18.67,night:12.19,eve:15.11,morn:18.67},pressure:1013.89,humidity:100,weather:[{id:501,main:"Rain",description:"moderate rain",icon:"10d"}],speed:2.97,deg:349,clouds:76,rain:4.15},{dt:1465902e3,temp:{day:15.9,min:13.33,max:15.9,night:13.91,eve:14.96,morn:13.33},pressure:1011.28,humidity:100,weather:[{id:500,main:"Rain",description:"light rain",icon:"10d"}],speed:2.72,deg:212,clouds:80,rain:2.78},{dt:1465988400,temp:{day:15.45,min:11.66,max:15.45,night:11.66,eve:15.16,morn:14.21},pressure:1012.51,humidity:98,weather:[{id:500,main:"Rain",description:"light rain",icon:"10d"}],speed:4.81,deg:215,clouds:80},{dt:1466074800,temp:{day:14.79,min:14.61,max:15.04,night:14.83,eve:15.04,morn:14.61},pressure:1014.01,humidity:0,weather:[{id:502,main:"Rain",description:"heavy intensity rain",icon:"10d"}],speed:5.34,deg:338,clouds:98,rain:28.08},{dt:1466161200,temp:{day:15.92,min:12.59,max:15.92,night:12.59,eve:14.13,morn:14.93},pressure:1027.02,humidity:0,weather:[{id:500,main:"Rain",description:"light rain",icon:"10d"}],speed:6.34,deg:3,clouds:26,rain:1.59},{dt:1466247600,temp:{day:14.17,min:12.69,max:14.26,night:13.27,eve:14.26,morn:12.69},pressure:1024.61,humidity:0,weather:[{id:500,main:"Rain",description:"light rain",icon:"10d"}],speed:4.96,deg:335,clouds:31,rain:1.23},{dt:1466334e3,temp:{day:15.45,min:14.19,max:15.46,night:14.28,eve:15.46,morn:14.19},pressure:1028.33,humidity:0,weather:[{id:500,main:"Rain",description:"light rain",icon:"10d"}],speed:5.95,deg:308,clouds:94,rain:1.61}]},o={"01d":"wi-day-sunny","02d":"wi-day-cloudy","03d":"wi-cloudy","04d":"wi-cloudy-windy","09d":"wi-showers","10d":"wi-rain","11d":"wi-thunderstorm","13d":"wi-snow","50d":"wi-fog","01n":"wi-night-clear","02n":"wi-night-cloudy","03n":"wi-night-cloudy","04n":"wi-night-cloudy","09n":"wi-night-showers","10n":"wi-night-rain","11n":"wi-night-thunderstorm","13n":"wi-night-snow","50n":"wi-night-alt-cloudy-windy"},r={element:"#weatherforecast",url:"http://api.openweathermap.org/data/2.5/forecast/daily?units={3}&lat={0}&lon={1}&appid={2}",account:config.weather.accounts[0].account,key:config.weather.accounts[0].token,dateFormat:"ddd",units:"metric",refresh:15,debug:!1},d=function(e){r=$.extend({},r,e),r.element=$(r.element),r.debug=r.debug?r.debug:config.debug,r.element.addClass("module refresh")},u=function(){navigator.geolocation.getCurrentPosition(s,l)},s=function(e){n=e.coords.latitude,i=e.coords.longitude,h()},l=function(t){console.warn(e.capitalize(),"No location found"),h()},c=function(){r.url=r.url.format(n,i,r.key,r.units)},m=function(){$.getJSON(r.url,function(e){_.isEqual(e,a)||(a=e,f())},function(){console.warn(e.capitalize(),"No data found")})},f=function(){sffjs.setCulture("nl-NL");var t=g(a.list),n=$('<thead><tr><th></th><th class="icon"></th><th></th><th></th></tr></thead>'),i=$("<table>");i.addClass("fader"),i.addClass("gradient"),i.append(n),i.append(t),r.element.html(i),console.log(e.capitalize(),"Last update",(new Date).format("yyyy-MM-dd HH:mm"))},g=function(e){var t=$("<tbody>");return e.forEach(function(e){var n="metric"==r.units?"&deg;":"",i=new Date(1e3*e.dt).format(r.dateFormat),a=$("<td>").html(i),d=$("<td>").addClass("highlight wi "+o[$(e.weather).get(0).icon]),u=$("<td>").addClass("highlight").html(e.temp.max.toFixed(1)+n),s=$("<td>").html(e.temp.min.toFixed(1)+n),l=$("<tr>").append(a).append(d).append(u).append(s);t.append(l)}),t},h=function(){c(),m(),p(!1),y()},w=function(){y();var n=(new Date,_.map(a.list,function(e){var t=new Date,n=new Date(1e3*e.dt),i=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes()+r.refresh);return t.getDate()==n.getDate()&&i>t}));_.contains(!0,n)||(console.log(e.capitalize(),"Refresh",(new Date).format("yyyy-MM-dd HH:mm")),window.clearTimeout(t),p(),u())},p=function(e){"undefined"!=typeof e?r.element.toggleClass("refresh",e):r.element.toggleClass("refresh")},y=function(){window.clearTimeout(t),t=window.setTimeout(w,60*Math.round(r.refresh/3)*1e3)};return{name:e,init:function(e){d(e)},start:function(){return r.debug?(f(),void p()):void u()},refresh:function(){w()}}}();